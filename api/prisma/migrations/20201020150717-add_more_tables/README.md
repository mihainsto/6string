# Migration `20201020150717-add_more_tables`

This migration has been generated by mihainsto at 10/20/2020, 6:07:17 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TYPE "blog"."Difficulty" AS ENUM ('EASY', 'MEDIUM', 'HARD')

CREATE TYPE "blog"."GuitarStyle" AS ENUM ('STRUM', 'FINGERPICK')

CREATE TYPE "blog"."GuitarOrientation" AS ENUM ('LEFT_HANDED', 'RIGHT_HANDED')

CREATE TYPE "blog"."GuitarType" AS ENUM ('CLASSICAL', 'ACOUSTIC', 'ELECTRICAL')

ALTER TABLE "blog"."User" ADD COLUMN "avatarUrl" text   

CREATE TABLE "blog"."PlaygroundSettings" (
"id" SERIAL,
"userId" text   NOT NULL ,
"guitarStyle" "GuitarStyle"  NOT NULL ,
"guitarOrientation" "GuitarOrientation"  NOT NULL ,
"guitarType" "GuitarType"  NOT NULL ,
PRIMARY KEY ("id")
)

CREATE TABLE "blog"."Song" (
"id" text   NOT NULL ,
"createdAt" timestamp(3)   NOT NULL DEFAULT CURRENT_TIMESTAMP,
"updatedAt" timestamp(3)   NOT NULL ,
"title" text   NOT NULL ,
"artist" text   NOT NULL ,
"postedById" text   NOT NULL ,
"difficulty" "Difficulty"  NOT NULL ,
"tuning" text   ,
"style" "GuitarStyle"  ,
"tab" text   NOT NULL ,
PRIMARY KEY ("id")
)

CREATE UNIQUE INDEX "PlaygroundSettings_userId_unique" ON "blog"."PlaygroundSettings"("userId")

ALTER TABLE "blog"."PlaygroundSettings" ADD FOREIGN KEY ("userId")REFERENCES "blog"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE

ALTER TABLE "blog"."Song" ADD FOREIGN KEY ("postedById")REFERENCES "blog"."User"("id") ON DELETE CASCADE ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200724181653-init..20201020150717-add_more_tables
--- datamodel.dml
+++ datamodel.dml
@@ -1,27 +1,43 @@
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url = "***"
 }
 generator client {
   provider = "prisma-client-js"
+  // previewFeatures = []
 }
+generator dbml {
+  provider = "prisma-dbml-generator"
+}
+
 model User {
-  id        String   @default(cuid()) @id
+  id        String   @id @default(cuid())
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
   email     String   @unique
   password  String
   firstname String?
   lastname  String?
   posts     Post[]
   role      Role
+  avatarUrl String?
+  playgroundSettings   PlaygroundSettings?
 }
+model PlaygroundSettings {
+  id        Int    @id @default(autoincrement())
+  user      User   @relation(fields: [userId], references: [id])
+  userId    String
+  guitarStyle GuitarStyle
+  guitarOrientation GuitarOrientation
+  guitarType GuitarType
+
+}
 model Post {
-  id        String   @default(cuid()) @id
+  id        String   @id @default(cuid())
   createdAt DateTime @default(now())
   updatedAt DateTime @updatedAt
   published Boolean
   title     String
@@ -32,5 +48,38 @@
 enum Role {
   ADMIN
   USER
-}
+}
+
+enum Difficulty {
+  EASY
+  MEDIUM
+  HARD
+}
+
+enum GuitarStyle {
+  STRUM
+  FINGERPICK
+}
+enum GuitarOrientation {
+  LEFT_HANDED
+  RIGHT_HANDED
+}
+enum GuitarType {
+  CLASSICAL
+  ACOUSTIC
+  ELECTRICAL
+}
+model Song {
+    id         String   @id @default(cuid())
+    createdAt  DateTime @default(now())
+    updatedAt  DateTime @updatedAt
+    title      String
+    artist     String
+    postedBy   User    @relation(fields: [postedById], references: [id])
+    postedById String
+    difficulty Difficulty
+    tuning     String?
+    style      GuitarStyle?
+    tab        String
+}
```


